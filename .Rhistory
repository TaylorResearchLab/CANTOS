ggsave(p5, filename ="Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 50, units = "cm")
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = 40, face = "bold"),axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = 40, face = "bold"),axis.text=element_text(size=40),
axis.title=element_text(size=40,face="bold"))
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = 40, face = "bold"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"))
a1
title_size=40
axis_size=15
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a3<-ggplot(Kmeans_silhouette_all_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_v3[which.max(Kmeans_silhouette_all_edition_v3$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("c")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a4<-ggplot(Kmeans_silhouette_5th_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_v3[which.max(Kmeans_silhouette_5th_edition_v3$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("d")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
p5<-ggarrange(a1, a2,a3,a4,nrow = 2,ncol = 2)
ggsave(p5, filename ="Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 50, units = "cm")
ggsave(p5, filename ="Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 100, units = "cm")
ggsave(p5, filename ="Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 300, width = 300, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 150, width = 150, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 140, width = 140, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
), width = 140, units = "cm")
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 140, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 130, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 60, width = 120, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 100, width = 120, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 120, width = 120, units = "cm",  dpi = 300,
)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script3.RData")
View(apclust_cosine)
View(affinity_cluster_cosine_df)
View(clust_plot_lv)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script3_5thed.RData")
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6a.RData")
View(af_clust_euclidean)
View(cluster_frequency_table)
View(affinity_cluster_df)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6a_5thed.RData")
View(affinity_cluster_df)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6a.RData")
length(unique(affinity_cluster_df$Cluster_ID))
View(cluster_frequency_table)
View(af_clust_euclidean)
View(affinity_cluster_df)
View(affinity_cluster_df)
length(unique(affinity_cluster_df$Cluster_ID))
results_dir
a<-unique(affinity_cluster_df$Cluster_ID)
a
results_dir
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6a_5thed.RData")
length(unique(affinity_cluster_df$Cluster_ID))
View(affinity_cluster_df)
a<-unique(affinity_cluster_df$Cluster_ID)
a
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6B_affinitycluster_v3_5thed.RData")
a<-unique(affinity_cluster_df$Cluster_ID)
View(affinity_cluster_v3_df)
length(unique(affinity_cluster_v3_df$Cluster_ID))
results_dir
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script6B.RData")
length(unique(affinity_cluster_v3_df$Cluster_ID))
library(ggpubr)
library(ggplot2)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script5a.RData")
Kmeans_silhouette_all_edition_ada2<- Kmeans_silhouette
Kmeans_silhouette_all_edition_ada2$k<-as.character(Kmeans_silhouette_all_edition_ada2$k)
# lollipop plot
title_size=40
axis_size=15
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1")))
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script5a_5thed.RData")
Kmeans_silhouette_5th_edition_ada2<- Kmeans_silhouette
Kmeans_silhouette_5th_edition_ada2$k<-as.character(Kmeans_silhouette_5th_edition_ada2$k)
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1","Kmeans_silhouette_5th_edition_ada2")))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
library(ggpubr)
library(ggplot2)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script5a.RData")
Kmeans_silhouette_all_edition_ada2<- Kmeans_silhouette
Kmeans_silhouette_all_edition_ada2$k<-as.character(Kmeans_silhouette_all_edition_ada2$k)
# lollipop plot
title_size=40
axis_size=15
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1","title_size","axis_size")))
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script5a_5thed.RData")
Kmeans_silhouette_5th_edition_ada2<- Kmeans_silhouette
Kmeans_silhouette_5th_edition_ada2$k<-as.character(Kmeans_silhouette_5th_edition_ada2$k)
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1","Kmeans_silhouette_5th_edition_ada2","title_size","axis_size")))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script-5B.RData")
Kmeans_silhouette_all_edition_v3<- Kmeans_silhouette
Kmeans_silhouette_all_edition_v3$k<-as.character(Kmeans_silhouette_all_edition_v3$k)
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1","Kmeans_silhouette_5th_edition_ada2","a2",
"Kmeans_silhouette_all_edition_v3","title_size","axis_size")))
a3<-ggplot(Kmeans_silhouette_all_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_v3[which.max(Kmeans_silhouette_all_edition_v3$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("c")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script-5b5thed-aug21.RData")
Kmeans_silhouette_5th_edition_v3<- Kmeans_silhouette
Kmeans_silhouette_5th_edition_v3$k<-as.character(Kmeans_silhouette_5th_edition_v3$k)
rm(list=setdiff(ls(), c("Kmeans_silhouette_all_edition_ada2","a1","Kmeans_silhouette_5th_edition_ada2","a2","a3","Kmeans_silhouette_5th_edition_v3",
"Kmeans_silhouette_all_edition_v3","title_size","axis_size")))
a4<-ggplot(Kmeans_silhouette_5th_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_v3[which.max(Kmeans_silhouette_5th_edition_v3$mean_silhouette_score), ], color="red")+
ylab("Mean Silhouette Score")+ggtitle("d")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
View(a1)
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=12)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=5)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a1
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=5)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red",size=5)+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a3<-ggplot(Kmeans_silhouette_all_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_v3[which.max(Kmeans_silhouette_all_edition_v3$mean_silhouette_score), ], color="red",size=5)+
ylab("Mean Silhouette Score")+ggtitle("c")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a4<-ggplot(Kmeans_silhouette_5th_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_v3[which.max(Kmeans_silhouette_5th_edition_v3$mean_silhouette_score), ], color="red",size=5)+
ylab("Mean Silhouette Score")+ggtitle("d")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
p5<-ggarrange(a1, a2,a3,a4,nrow = 2,ncol = 2)
a1
a2
a3
a4
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
red_dot_size=10
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a3<-ggplot(Kmeans_silhouette_all_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_v3[which.max(Kmeans_silhouette_all_edition_v3$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("c")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a4<-ggplot(Kmeans_silhouette_5th_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_v3[which.max(Kmeans_silhouette_5th_edition_v3$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("d")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
p5<-ggarrange(a1, a2,a3,a4,nrow = 2,ncol = 2)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
axis_size=20
a4<-ggplot(Kmeans_silhouette_5th_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_v3[which.max(Kmeans_silhouette_5th_edition_v3$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("d")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a3<-ggplot(Kmeans_silhouette_all_edition_v3, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_v3[which.max(Kmeans_silhouette_all_edition_v3$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("c")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a2<-ggplot(Kmeans_silhouette_5th_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_5th_edition_ada2[which.max(Kmeans_silhouette_5th_edition_ada2$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("b")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
a1<-ggplot(Kmeans_silhouette_all_edition_ada2, aes(x=k, y=mean_silhouette_score)) +
geom_segment( aes(x=fct_inorder(k), xend=k, y=0, yend=mean_silhouette_score)) +geom_point()  +
geom_point(data = Kmeans_silhouette_all_edition_ada2[which.max(Kmeans_silhouette_all_edition_ada2$mean_silhouette_score), ], color="red",size=red_dot_size)+
ylab("Mean Silhouette Score")+ggtitle("a")+theme(plot.title = element_text(size = title_size, face = "bold"),axis.text=element_text(size=axis_size),
axis.title=element_text(size=axis_size,face="bold"))
p5<-ggarrange(a1, a2,a3,a4,nrow = 2,ncol = 2)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
p5<-ggarrange(a1, a2,a3,a4,nrow = 4,ncol = 1)
ggsave(p5, filename ="Paper/plots/Kmeans_Silhouette_Score_Embeddings_all.png",, height = 50, width = 120, units = "cm",  dpi = 300,
)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script10_aug21_5thed.RData")
View(WHO_Terms_5th)
View(WHO_Results_df)
View(WHO_Terms_5th)
result_dir
nested_affinity_cluster_cosine <- read_csv(paste(result_dir,"/nested_affinity_cluster_cosine.csv",sep=""))
View(nested_affinity_cluster_cosine)
View(cluster_label_assignment_refined)
View(outlier_detection_edit_dist)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script10_aug21_5thed.RData")
View(edit_distance_cluster_reassignment)
View(cluster_label_assignment_refined)
View(nested_affinity_cluster_jw)
view(nested_affinity_cluster_cosine)
suppressPackageStartupMessages({
library(dplyr)
library(data.table)
library(ggplot2)
library(tidyverse)
library(stringi)
library(readxl)
library(dbscan)
library(isotree)
library(qdapRegex)
library(ghql)
})
setwd(getwd())
root_dir <- rprojroot::find_root(rprojroot::has_dir(".git"))
util_dir <- file.path(root_dir, "util")
data_dir <- file.path(root_dir,"data")
input_dir <- file.path(root_dir,"input")
analysis_dir <- file.path(root_dir,"analysis")
intermediate_dir <- file.path(analysis_dir,"intermediate_5th")
result_dir <- file.path(analysis_dir,"results_5th")
source(paste(util_dir,"/cluster_label_assignment_refined.R",sep=""))
source(paste(util_dir,"/outlier_detection_edit_dist.R",sep=""))
source(paste(util_dir,"/edit_distance_cluster_reassignment.R",sep=""))
affinity_cluster_v3_reassigned_df<-read.csv(paste(intermediate_dir,"/affinity_cluster_v3_reassigned_df_5thed.csv",sep=""))
affinity_cluster_v3_reassigned_df<-affinity_cluster_v3_reassigned_df[,c(-1)]
# Read ADA2
affinity_cluster_ADA2_reassigned_df<-read.csv(paste(intermediate_dir,"/affinity_cluster_ADA2_reassigned_df_5thed.csv",sep=""))
affinity_cluster_ADA2_reassigned_df<-affinity_cluster_ADA2_reassigned_df[,c(-1)]
#Read Kmeans
kmeans_clust_result_embedding_ADA2 <- read_csv(paste(result_dir,"/kmeans_clust_result_embedding_ada2_5thed.csv",sep=""))
kmeans_clust_result_embedding_ADA2<-kmeans_clust_result_embedding_ADA2[,c(-1)]
kmeans_clust_result_embedding_V3 <- read_csv(paste(result_dir,"/kmeans_clust_result_embedding_v3_5thed.csv",sep=""))
kmeans_clust_result_embedding_V3<-kmeans_clust_result_embedding_V3[,c(-1)]
# Read edit distance cluster
nested_affinity_cluster_cosine <- read_csv(paste(result_dir,"/nested_affinity_cluster_cosine.csv",sep=""))
nested_affinity_cluster_jw <- read_csv(paste(result_dir,"/nested_affinity_cluster_jw.csv",sep=""))
nested_affinity_cluster_lv <- read_csv(paste(result_dir,"/nested_affinity_cluster_lv.csv",sep=""))
nested_affinity_cluster_cosine<-nested_affinity_cluster_cosine[,c(-1,-8)]
nested_affinity_cluster_jw<-nested_affinity_cluster_jw[,c(-1,-8)]
nested_affinity_cluster_lv<-nested_affinity_cluster_lv[,c(-1,-8)]
affinity_cluster_v3_reassigned_df<-affinity_cluster_v3_reassigned_df[,c(-1)]
affinity_cluster_ADA2_reassigned_df<-affinity_cluster_ADA2_reassigned_df[,c(-1)]
nested_affinity_cluster_cosine<-nested_affinity_cluster_cosine[,c(-1)]
nested_affinity_cluster_jw<-nested_affinity_cluster_jw[,c(-1)]
nested_affinity_cluster_lv<-nested_affinity_cluster_lv[,c(-1)]
tumor_nct_map <- kmeans_clust_result_embedding_ADA2 %>% dplyr::select(nct_id,Tumor_Names)
affinity_cluster_v3_reassigned_df<-affinity_cluster_v3_reassigned_df %>% left_join(tumor_nct_map,by="Tumor_Names")
affinity_cluster_ADA2_reassigned_df<-affinity_cluster_ADA2_reassigned_df %>% left_join(tumor_nct_map,by="Tumor_Names")
nested_affinity_cluster_cosine<-nested_affinity_cluster_cosine %>% left_join(tumor_nct_map,by="Tumor_Names")
nested_affinity_cluster_jw<-nested_affinity_cluster_jw %>% left_join(tumor_nct_map,by="Tumor_Names")
nested_affinity_cluster_lv<-nested_affinity_cluster_lv %>% left_join(tumor_nct_map,by="Tumor_Names")
affinity_cluster_v3_reassigned_df<-affinity_cluster_v3_reassigned_df[,c(10,1:9)]
affinity_cluster_ADA2_reassigned_df<-affinity_cluster_ADA2_reassigned_df[,c(10,1:9)]
nested_affinity_cluster_cosine<-nested_affinity_cluster_cosine[,c(6,1:5)]
nested_affinity_cluster_jw<-nested_affinity_cluster_jw[,c(6,1:5)]
nested_affinity_cluster_lv<-nested_affinity_cluster_lv[,c(6,1:5)]
# Find the WHO and NCIT closest matches
who_ncit_match_ADA2 <- affinity_cluster_ADA2_reassigned_df %>% dplyr::select(Tumor_Names,WHO_Matches,WHO_distance,NCIT_Matches,NCIT_distance)
who_ncit_match_v3 <- affinity_cluster_v3_reassigned_df %>% dplyr::select(Tumor_Names,WHO_Matches,WHO_distance,NCIT_Matches,NCIT_distance)
# Join the matches to Kmeans
kmeans_clust_result_embedding_ADA2<-kmeans_clust_result_embedding_ADA2 %>% dplyr::select(nct_id,Tumor_Names,cluster)
kmeans_clust_result_embedding_V3<-kmeans_clust_result_embedding_V3 %>% dplyr::select(nct_id,Tumor_Names,cluster)
colnames(kmeans_clust_result_embedding_ADA2)[3]<-c("Cluster_ID")
colnames(kmeans_clust_result_embedding_V3)[3]<-c("Cluster_ID")
kmeans_clust_result_embedding_ADA2<-kmeans_clust_result_embedding_ADA2 %>% dplyr::left_join(who_ncit_match_ADA2,by="Tumor_Names")
kmeans_clust_result_embedding_V3<-kmeans_clust_result_embedding_V3 %>% dplyr::left_join(who_ncit_match_v3,by="Tumor_Names")
kmeans_clust_result_embedding_ADA2<- cluster_label_assignment_refined(kmeans_clust_result_embedding_ADA2)
kmeans_clust_result_embedding_V3<- cluster_label_assignment_refined(kmeans_clust_result_embedding_V3)
View(nested_affinity_cluster_cosine)
nested_affinity_cluster_cosine<-nested_affinity_cluster_cosine %>% dplyr::select(nct_id,Tumor_Names,Cluster_ID)
nested_affinity_cluster_jw<-nested_affinity_cluster_jw %>% dplyr::select(nct_id,Tumor_Names,Cluster_ID)
nested_affinity_cluster_lv<-nested_affinity_cluster_lv %>% dplyr::select(nct_id,Tumor_Names,Cluster_ID)
dissimilarity_matrix_cosine<-load(paste(intermediate_dir,"/dissimilarity_matrix_cosine.RData",sep=""))
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/dissimilarity_matrix_jw.RData")
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/dissimilarity_matrix_lv.RData")
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/dissimilarity_matrix_cosine.RData")
dissimilarity_matrix_cosine<-as.data.frame(dissimilarity_matrix_cosine)
dissimilarity_matrix_jw<-as.data.frame(dissimilarity_matrix_jw)
dissimilarity_matrix_lv<-as.data.frame(dissimilarity_matrix_lv)
NCIT_embedding_df <-read.csv(paste(data_dir,"/dt_input_file_6_dec/NCIT_Neoplasm_Core_terms_text-embedding-ada-002_embeddings.csv",sep=""))
NCIT_embedding_df<-NCIT_embedding_df[c(-1),] # Remove the header (column name) embedding
rownames(NCIT_embedding_df)<-NULL
NCIT_Tumors<-tolower(NCIT_embedding_df$Disease)
rm(NCIT_embedding_df)
WHO_Terms_All <-readxl::read_xlsx(paste(data_dir,"/WHO_Tumors/result/WHO_Tumor_all_edition.xlsx",sep=""))
WHO_Terms_5th<-WHO_Terms_All%>%filter(edition_5th=="Yes")
dissimilarity_matrix_cosine_who <- dissimilarity_matrix_cosine %>% dplyr::select(one_of(WHO_Terms_5th$Tumor_Names))
dissimilarity_matrix_jw_who <- dissimilarity_matrix_jw %>% dplyr::select(one_of(WHO_Terms_5th$Tumor_Names))
dissimilarity_matrix_lv_who <- dissimilarity_matrix_lv %>% dplyr::select(one_of(WHO_Terms_5th$Tumor_Names))
dissimilarity_matrix_cosine_ncit <- dissimilarity_matrix_cosine %>% dplyr:::select(one_of(NCIT_Tumors))
dissimilarity_matrix_jw_ncit <- dissimilarity_matrix_jw %>% dplyr:::select(one_of(NCIT_Tumors))
dissimilarity_matrix_lv_ncit <- dissimilarity_matrix_lv %>% dplyr:::select(one_of(NCIT_Tumors))
index_min_who_cosine <- as.matrix(apply(dissimilarity_matrix_cosine_who, 1, which.min))
index_min_who_jw <- as.matrix(apply(dissimilarity_matrix_jw_who, 1, which.min))
index_min_who_lv <- as.matrix(apply(dissimilarity_matrix_lv_who, 1, which.min))
who_match_cosine_df <- cbind(rownames(dissimilarity_matrix_cosine_who))
who_match_jw_df <- cbind(rownames(dissimilarity_matrix_jw_who))
who_match_lv_df <- cbind(rownames(dissimilarity_matrix_lv_who))
colnames(who_match_cosine_df)<-"Tumor_Names"
colnames(who_match_jw_df)<-"Tumor_Names"
colnames(who_match_lv_df)<-"Tumor_Names"
who_match_cosine_df <-as.data.frame(who_match_cosine_df)
who_match_jw_df <-as.data.frame(who_match_jw_df)
who_match_lv_df <-as.data.frame(who_match_lv_df)
who_match_cosine_df$WHO_Matches<- NA
who_match_cosine_df$WHO_distance<-NA
who_match_jw_df$WHO_Matches<- NA
who_match_jw_df$WHO_distance<-NA
who_match_lv_df$WHO_Matches<- NA
who_match_lv_df$WHO_distance<-NA
dim(who_match_cosine_df)[1]
for (iter in 1: dim(who_match_cosine_df)[1]){
who_match_cosine_df$WHO_Matches[iter] <- colnames(dissimilarity_matrix_cosine_who)[index_min_who_cosine[iter]]
who_match_cosine_df$WHO_distance[iter]<-dissimilarity_matrix_cosine_who[iter,index_min_who_cosine[iter]]
who_match_jw_df$WHO_Matches[iter] <- colnames(dissimilarity_matrix_jw_who)[index_min_who_jw[iter]]
who_match_jw_df$WHO_distance[iter]<-dissimilarity_matrix_jw_who[iter,index_min_who_jw[iter]]
who_match_lv_df$WHO_Matches[iter] <- colnames(dissimilarity_matrix_lv_who)[index_min_who_lv[iter]]
who_match_lv_df$WHO_distance[iter]<-dissimilarity_matrix_lv_who[iter,index_min_who_lv[iter]]
}
index_min_ncit_cosine <- as.matrix(apply(dissimilarity_matrix_cosine_ncit, 1, which.min))
index_min_ncit_jw <- as.matrix(apply(dissimilarity_matrix_jw_ncit, 1, which.min))
index_min_ncit_lv <- as.matrix(apply(dissimilarity_matrix_lv_ncit, 1, which.min))
ncit_match_cosine_df <- cbind(rownames(dissimilarity_matrix_cosine_ncit))
ncit_match_jw_df <- cbind(rownames(dissimilarity_matrix_jw_ncit))
ncit_match_lv_df <- cbind(rownames(dissimilarity_matrix_lv_ncit))
colnames(ncit_match_cosine_df)<-"Tumor_Names"
colnames(ncit_match_jw_df)<-"Tumor_Names"
colnames(ncit_match_lv_df)<-"Tumor_Names"
ncit_match_cosine_df <-as.data.frame(ncit_match_cosine_df)
ncit_match_jw_df <-as.data.frame(ncit_match_jw_df)
ncit_match_lv_df <-as.data.frame(ncit_match_lv_df)
ncit_match_cosine_df$NCIT_Matches<- NA
ncit_match_cosine_df$NCIT_distance<-NA
ncit_match_jw_df$NCIT_Matches<- NA
ncit_match_jw_df$NCIT_distance<-NA
ncit_match_lv_df$NCIT_Matches<- NA
ncit_match_lv_df$NCIT_distance<-NA
for (iter in 1: dim(ncit_match_cosine_df)[1]){
ncit_match_cosine_df$NCIT_Matches[iter] <- colnames(dissimilarity_matrix_cosine_ncit)[index_min_ncit_cosine[iter]]
ncit_match_cosine_df$NCIT_distance[iter]<-dissimilarity_matrix_cosine_ncit[iter,index_min_ncit_cosine[iter]]
ncit_match_jw_df$NCIT_Matches[iter] <- colnames(dissimilarity_matrix_jw_ncit)[index_min_ncit_jw[iter]]
ncit_match_jw_df$NCIT_distance[iter]<-dissimilarity_matrix_jw_ncit[iter,index_min_ncit_jw[iter]]
ncit_match_lv_df$NCIT_Matches[iter] <- colnames(dissimilarity_matrix_lv_ncit)[index_min_ncit_lv[iter]]
ncit_match_lv_df$NCIT_distance[iter]<-dissimilarity_matrix_lv_ncit[iter,index_min_ncit_lv[iter]]
}
nested_affinity_cluster_cosine<- nested_affinity_cluster_cosine %>% dplyr::left_join(who_match_cosine_df,by="Tumor_Names")
nested_affinity_cluster_cosine<- nested_affinity_cluster_cosine %>% dplyr::left_join(ncit_match_cosine_df,by="Tumor_Names")
nested_affinity_cluster_jw<- nested_affinity_cluster_jw %>% dplyr::left_join(who_match_jw_df,by="Tumor_Names")
nested_affinity_cluster_jw<- nested_affinity_cluster_jw %>% dplyr::left_join(ncit_match_jw_df,by="Tumor_Names")
nested_affinity_cluster_lv<- nested_affinity_cluster_lv %>% dplyr::left_join(who_match_lv_df,by="Tumor_Names")
nested_affinity_cluster_lv<- nested_affinity_cluster_lv %>% dplyr::left_join(ncit_match_lv_df,by="Tumor_Names")
affinity_cluster_nested<-nested_affinity_cluster_cosine
view(affinity_cluster_nested)
affinity_cluster_nested$who_cluster_label<- NA
affinity_cluster_nested$ncit_cluster_label<- NA
subcluster_id_list<- unique(affinity_cluster_nested$Cluster_ID)
subcluster_id_list
iter=5
cluster_id_affinity <- subcluster_id_list[iter]
index_affinity <- which (affinity_cluster_nested$Cluster_ID==cluster_id_affinity)
#totaling_table <- as.data.frame(table(affinity_cluster_nested$assigned_class[index_affinity]))
totaling_table_who <- as.data.frame(table(affinity_cluster_nested$WHO_Matches[index_affinity]))
totaling_table_ncit <- as.data.frame(table(affinity_cluster_nested$NCIT_Matches[index_affinity]))
view(totaling_table_who)
iter=4
cluster_id_affinity <- subcluster_id_list[iter]
index_affinity <- which (affinity_cluster_nested$Cluster_ID==cluster_id_affinity)
#totaling_table <- as.data.frame(table(affinity_cluster_nested$assigned_class[index_affinity]))
totaling_table_who <- as.data.frame(table(affinity_cluster_nested$WHO_Matches[index_affinity]))
totaling_table_ncit <- as.data.frame(table(affinity_cluster_nested$NCIT_Matches[index_affinity]))
view(totaling_table_who)
iter=88
cluster_id_affinity <- subcluster_id_list[iter]
index_affinity <- which (affinity_cluster_nested$Cluster_ID==cluster_id_affinity)
#totaling_table <- as.data.frame(table(affinity_cluster_nested$assigned_class[index_affinity]))
totaling_table_who <- as.data.frame(table(affinity_cluster_nested$WHO_Matches[index_affinity]))
totaling_table_ncit <- as.data.frame(table(affinity_cluster_nested$NCIT_Matches[index_affinity]))
view(totaling_table_who)
index_max_who<- which(totaling_table_who$Freq==max(totaling_table_who$Freq))
index_max_ncit<- which(totaling_table_ncit$Freq==max(totaling_table_ncit$Freq))
index_max_who
for (iter in 1:length(subcluster_id_list)){
cluster_id_affinity <- subcluster_id_list[iter]
index_affinity <- which (affinity_cluster_nested$Cluster_ID==cluster_id_affinity)
#totaling_table <- as.data.frame(table(affinity_cluster_nested$assigned_class[index_affinity]))
totaling_table_who <- as.data.frame(table(affinity_cluster_nested$WHO_Matches[index_affinity]))
totaling_table_ncit <- as.data.frame(table(affinity_cluster_nested$NCIT_Matches[index_affinity]))
index_max_who<- which(totaling_table_who$Freq==max(totaling_table_who$Freq))
index_max_ncit<- which(totaling_table_ncit$Freq==max(totaling_table_ncit$Freq))
if(length(index_max_who)==1){
affinity_cluster_nested$who_cluster_label[index_affinity]<- as.character(totaling_table_who$Var1[index_max_who])
}else{
print(iter)
break
}}
iter=1
cluster_id_affinity <- subcluster_id_list[iter]
index_affinity <- which (affinity_cluster_nested$Cluster_ID==cluster_id_affinity)
#totaling_table <- as.data.frame(table(affinity_cluster_nested$assigned_class[index_affinity]))
totaling_table_who <- as.data.frame(table(affinity_cluster_nested$WHO_Matches[index_affinity]))
totaling_table_ncit <- as.data.frame(table(affinity_cluster_nested$NCIT_Matches[index_affinity]))
index_max_who<- which(totaling_table_who$Freq==max(totaling_table_who$Freq))
index_max_who
view(totaling_table_who)
length(index_max_who)==1
high_freq_labels<-as.character(totaling_table_who$Var1[index_max_who])
other_freq_label <- affinity_cluster_nested %>% filter(Cluster_ID==cluster_id_affinity)%>%dplyr::select(WHO_Matches)%>%distinct()
other_freq_label<-other_freq_label$WHO_Matches
other_freq_label<-setdiff(other_freq_label,high_freq_labels)
high_freq_labels
other_freq_label
View(affinity_cluster_nested)
iter
for(iter_high_freq in 1:length(high_freq_labels)){
index_locator_high<-which(affinity_cluster_nested$WHO_Matches==high_freq_labels[iter_high_freq])
index_locator_high <- intersect(index_locator_high,index_affinity)
affinity_cluster_nested$who_cluster_label[index_locator_high]<-high_freq_labels[iter_high_freq]
}
length(other_freq_label)>=1
other_freq_label
for(iter_other_freq in 1:length(other_freq_label)){
index_locator_other<-which(affinity_cluster_nested$WHO_Matches==other_freq_label[iter_other_freq])
index_locator_other <- intersect(index_locator_other,index_affinity)
affinity_cluster_nested$who_cluster_label[index_locator_other]<-other_freq_label[iter_other_freq]
}
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script3_5thed.RData")
View(edit_distance_nested_cluster)
load("/Users/lahiria/Desktop/MTP_Paper/temp/CT-Large-File-June21/script10_aug21_5thed.RData")
View(cluster_label_assignment_refined)
View(tumor_sample_df)
